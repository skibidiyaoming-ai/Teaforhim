<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tea for Men</title>
<style>
  body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    background: #0a0a0a;
    color: #fff;
  }

  header {
    position: fixed;
    top: 0;
    width: 100%;
    background: #111;
    padding: 15px;
    text-align: center;
    font-size: 1.5em;
    color: #00ffcc;
    z-index: 100;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
  }

  main {
    margin-top: 70px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    padding-bottom: 100px;
  }

  .post-box {
    background: #1a1a1a;
    padding: 15px;
    margin: 10px 0;
    border-radius: 15px;
  }

  textarea, input, select {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    border-radius: 10px;
    border: none;
    outline: none;
    background: #222;
    color: #fff;
  }

  .btn {
    display: inline-block;
    margin: 5px;
    padding: 8px 12px;
    border-radius: 50px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .btn:hover { transform: scale(1.1); }

  .like-btn { background: #ff3e3e; color: #fff; }
  .comment-btn { background: #3e7eff; color: #fff; }
  .flag-green { background: #00ff66; color: #111; }
  .flag-red { background: #ff0000; color: #fff; }

  .feed { margin-top: 20px; }
  .post {
    background: #111;
    border-radius: 20px;
    margin: 20px 0;
    padding: 20px;
    position: relative;
    overflow: hidden;
  }

  .post-author {
    font-weight: bold;
    font-size: 1.1em;
    margin-bottom: 10px;
    color: #00ffcc;
  }

  .post-text {
    font-size: 1.2em;
    line-height: 1.4em;
    margin-bottom: 15px;
  }

  .post-actions {
    position: absolute;
    right: 15px;
    top: 50px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .post-actions button {
    margin: 8px 0;
    width: 50px;
    height: 50px;
    border-radius: 50%;
  }

  .comments {
    margin-top: 15px;
    background: #222;
    padding: 10px;
    border-radius: 15px;
  }

  .comment {
    margin: 5px 0;
    padding: 5px 10px;
    border-radius: 10px;
    background: #333;
  }

  input.comment-input {
    width: calc(100% - 90px);
    display: inline-block;
    margin-right: 5px;
  }

  button.comment-submit {
    display: inline-block;
    padding: 8px 12px;
    border-radius: 50px;
    border: none;
    background: #3e7eff;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
  }
</style>
</head>
<body>
<header>‚òï Tea for Men</header>
<main>
  <div class="post-box">
    <textarea id="postInput" placeholder="Drop some tea..."></textarea>
    <select id="mode">
      <option value="anonymous">Anonymous</option>
      <option value="username">Username</option>
      <option value="pseudonym">Pseudonym</option>
    </select>
    <input id="usernameInput" type="text" placeholder="Enter username" style="display:none;">
    <button onclick="addPost()" class="btn like-btn">Post</button>
  </div>

  <div class="feed" id="feed"></div>
</main>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "YOUR_KEY",
    authDomain: "your-app.firebaseapp.com",
    projectId: "your-app",
    storageBucket: "your-app.appspot.com",
    messagingSenderId: "123456789",
    appId: "1:123456789:web:abcdef123456"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const modeSelect = document.getElementById('mode');
  const usernameInput = document.getElementById('usernameInput');
  modeSelect.addEventListener("change", () => {
    usernameInput.style.display = (modeSelect.value === "username") ? "block" : "none";
  });

  function generatePseudonym() {
    const animals = ["Tiger","Wolf","Falcon","Shark","Panther","Bear","Hawk"];
    const colors = ["Red","Blue","Green","Black","Silver","Gold","White"];
    return `${colors[Math.floor(Math.random()*colors.length)]}${animals[Math.floor(Math.random()*animals.length)]}${Math.floor(Math.random()*100)}`;
  }

  async function addPost() {
    const text = document.getElementById('postInput').value.trim();
    if (!text) return;

    let author = "Anonymous";
    if (modeSelect.value === "username") author = usernameInput.value.trim() || "Anonymous";
    else if (modeSelect.value === "pseudonym") author = generatePseudonym();

    await db.collection("posts").add({
      text, author, likes:0, greenFlags:0, redFlags:0, timestamp: Date.now()
    });
    document.getElementById('postInput').value = '';
  }

  function likePost(id, currentLikes) {
    db.collection("posts").doc(id).update({likes: currentLikes+1});
  }

  function flagPost(id, type, currentCount) {
    const field = type==="green"?"greenFlags":"redFlags";
    db.collection("posts").doc(id).update({[field]: currentCount+1});
  }

  async function addComment(postId) {
    const input = document.getElementById(`commentInput-${postId}`);
    const text = input.value.trim();
    if (!text) return;
    await db.collection("posts").doc(postId).collection("comments").add({text,timestamp:Date.now()});
    input.value = '';
  }

  db.collection("posts").orderBy("timestamp","desc").onSnapshot(snapshot=>{
    const feed = document.getElementById('feed');
    feed.innerHTML="";
    snapshot.forEach(doc=>{
      const data = doc.data();
      const postId = doc.id;

      const post = document.createElement("div");
      post.classList.add("post");
      post.innerHTML=`
        <div class="post-author">${data.author}</div>
        <div class="post-text">${data.text}</div>
        <div class="post-actions">
          <button class="like-btn" onclick="likePost('${postId}',${data.likes})">‚ù§Ô∏è ${data.likes}</button>
          <button class="flag-green" onclick="flagPost('${postId}','green',${data.greenFlags})">‚úÖ ${data.greenFlags}</button>
          <button class="flag-red" onclick="flagPost('${postId}','red',${data.redFlags})">üö© ${data.redFlags}</button>
        </div>
        <div class="comments">
          <input id="commentInput-${postId}" class="comment-input" placeholder="Comment...">
          <button class="comment-submit" onclick="addComment('${postId}')">Post</button>
          <div id="commentList-${postId}"></div>
        </div>
      `;
      feed.appendChild(post);

      db.collection("posts").doc(postId).collection("comments").orderBy("timestamp").onSnapshot(commentSnap=>{
        const list = document.getElementById(`commentList-${postId}`);
        if(list){
          list.innerHTML="";
          commentSnap.forEach(c=>{
            const div = document.createElement("div");
            div.classList.add("comment");
            div.textContent=c.data().text;
            list.appendChild(div);
          });
        }
      });
    });
  });
</script>
</body>
</html>
